trigger:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

steps:
# 1️⃣ Use Node 20 (same as App Service runtime)
- task: NodeTool@0
  inputs:
    versionSpec: '20.x'
  displayName: 'Use Node.js 20'

# 2️⃣ No build — zip raw source code only
- task: ArchiveFiles@2
  inputs:
    rootFolderOrFile: '$(Build.SourcesDirectory)'
    includeRootFolder: false
    archiveType: 'zip'
    archiveFile: '$(Build.ArtifactStagingDirectory)/frontend.zip'
    replaceExistingArchive: true
  displayName: 'Zip Source Code'

# 3️⃣ Deploy ZIP to App Service
- task: AzureWebApp@1
  inputs:
    azureSubscription: 'Azure-Service-Connection'
    appName: 'rg-opulanz-frontend'
    package: '$(Build.ArtifactStagingDirectory)/frontend.zip'
  displayName: 'Deploy to App Service'
